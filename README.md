# Uber-simple web app

An absolute bare-bones web app.

Generated by Stagehand. See LICENSE.
# dart_bug_30507

I've only changed main.dart to:

```
Future main() async {
  var client = new BrowserClient();
  var resp = await client.get('https://api.holibri.com/holibri/v1/countries/list?alt=json');

  bool incorrect = resp.headers.containsKey('\ncontent-type');
  querySelector('#output').text = 'Content-type header was ${incorrect ? 'incorrectly' : 'correctly'} retrieved/parsed';
}
```

Under IE11 and windows 8 (probably others as well) the page will output 'incorrectly'.


Feel free to use `https://api.holibri.com/holibri/v1/countries/list?alt=json` for testing.



If you want to recreate the server side:
========================================

`https://api.holibri.com/holibri/v1/countries/list?alt=json` is served by dart using the `rpc` package:

```
import 'dart:async';
import 'dart:io';
import 'package:holibri_server/api/holibri.dart';
import 'package:holibri_server/config/config.dart';
import 'package:rpc/rpc.dart';

final ApiServer _apiServer = new ApiServer();

Future<int> main() async {
  _apiServer.addApi(new Holibri());
  HttpServer server = await HttpServer.bind(InternetAddress.ANY_IP_V4, config.port);
  server.listen(_apiServer.httpRequestHandler);
  return new Future.value(0);
}
```

a docker instance provides the https support:

docker-compose.yml:
```
[...]
  holibri-server:
    image: "${REGISTRY}/${PREFIX}/holibri-server:${VERSION}"
    links:
      - db
      - shipping-gls
      - shipping-bringg
      - mail-server
    ports:
      - "28083:28083"
    volumes:
      - "${CONFIGURATION_DIR}/holibri-server:/app/main-app/lib/config/local_config"
    environment:
      - "VIRTUAL_HOST=api.holibri.com"
      - "LETSENCRYPT_HOST=api.holibri.com"
      - "LETSENCRYPT_EMAIL=
[...]
  letsencrypt-nginx-proxy-companion:
    image: jrcs/letsencrypt-nginx-proxy-companion
    volumes:
      - "${DATA_DIR}/nginx-proxy/certs:/etc/nginx/certs:rw"
      - "/var/run/docker.sock:/var/run/docker.sock:ro"
    volumes_from:
      - "nginx-proxy"
```

The letsencrypt-nginx-proxy-companion uses `/var/run/docker.sock` and does some magic so that all our docker services are https encrypted.


